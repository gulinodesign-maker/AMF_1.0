<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>Montalto Fisio</title>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <link rel="stylesheet" href="./styles.css?v=1.003" />
  <link rel="manifest" href="./manifest.json?v=1.003" />

  <link rel="apple-touch-icon" sizes="180x180" href="./assets/icons/apple-touch-icon.png?v=1.003" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="./assets/icons/apple-touch-icon.png?v=1.003" />
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/favicon-32.png?v=1.003" />
  <link rel="icon" type="image/png" sizes="16x16" href="./assets/icons/favicon-16.png?v=1.003" />

  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Montalto Fisio" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-left">
        <img class="logo" src="./assets/logo.jpg?v=1.003" alt="Logo" />
        <div class="top-led-grid" id="topLedGrid" aria-label="Stato" role="status">
          <span class="top-led" id="ledNet"></span>
          <span class="top-led" id="ledDbRead"></span>
          <span class="top-led" id="ledDbWrite"></span>
          <span class="top-led" id="ledErr"></span>
        </div>
        <h1 id="appTitle">Montalto Fisio</h1>
      </div>

      <div class="brand-right" aria-label="Azioni">
        <!-- Impostazioni: visibile solo in Home -->
        <button class="topbar-btn" id="btnSettings" type="button" aria-label="Impostazioni">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"></path>
            <path d="M19.4 15a7.9 7.9 0 0 0 .1-1l2-1.5-2-3.4-2.4 1a8.2 8.2 0 0 0-1.7-1L15 6h-6l-.4 3.1a8.2 8.2 0 0 0-1.7 1l-2.4-1-2 3.4 2 1.5a7.9 7.9 0 0 0 .1 1 7.9 7.9 0 0 0-.1 1l-2 1.5 2 3.4 2.4-1a8.2 8.2 0 0 0 1.7 1L9 22h6l.4-3.1a8.2 8.2 0 0 0 1.7-1l2.4 1 2-3.4-2-1.5a7.9 7.9 0 0 0 .1-1Z"></path>
          </svg>
        </button>

        <!-- Home: visibile fuori dalla Home, sempre all'estrema destra -->
        <button class="topbar-btn" id="btnHome" type="button" aria-label="Home">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 10.5 12 3l9 7.5"></path>
            <path d="M5 10v11h14V10"></path>
          </svg>
        </button>
      </div>
    </div>
    <div class="topbar-sep"></div>
  </header>

  <main>
    <section id="viewHome" class="home-screen" aria-label="Home">
      <div class="home-year-pill" id="homeYearPill" role="button" tabindex="0" aria-label="Anno di riferimento"></div>

      <div class="home-grid-1x3" role="navigation" aria-label="Sezioni">
        <button class="home-tile" id="tilePazienti" type="button" aria-label="Pazienti">
          <div class="home-tile-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <path d="M9 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z"></path>
              <path d="M20 8v6"></path><path d="M23 11h-6"></path>
            </svg>
          </div>
          <div class="home-tile-label">Pazienti</div>
        </button>

        <button class="home-tile" id="tileCalendario" type="button" aria-label="Calendario">
          <div class="home-tile-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M7 3v3"></path><path d="M17 3v3"></path><path d="M4.5 8h15"></path>
              <path d="M6 6h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z"></path>
              <path d="M8 12h3"></path><path d="M13 12h3"></path><path d="M8 16h3"></path><path d="M13 16h3"></path>
            </svg>
          </div>
          <div class="home-tile-label">Calendario</div>
        </button>

        <button class="home-tile" id="tileStatistiche" type="button" aria-label="Statistiche">
          <div class="home-tile-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M4 19V5"></path><path d="M4 19h16"></path>
              <path d="M8 17V11"></path><path d="M12 17V7"></path><path d="M16 17V13"></path>
            </svg>
          </div>
          <div class="home-tile-label">Statistiche</div>
        </button>
      </div>

      <div class="home-build" id="homeBuild">fm_1.003</div>
    </section>

    <section id="viewPazienti" class="card" style="display:none">
      <div class="row" style="justify-content:space-between">
        <div class="h2">Pazienti</div>
        <button class="btn" id="btnNewPatient" type="button">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14"></path><path d="M5 12h14"></path></svg>
          Aggiungi
        </button>
      </div>
      <div class="muted" id="patientsHint"></div>
      <div style="height:10px"></div>
      <div class="list" id="patientsList"></div>
    </section>

    <section id="viewCalendario" class="card" style="display:none">
      <div class="h2">Calendario (settimanale)</div>
      <div class="muted">Arriva nel prossimo step: qui mostreremo la settimana con le sedute generate.</div>
    </section>

    <section id="viewStatistiche" class="card" style="display:none">
      <div class="h2">Statistiche</div>
      <div class="muted">In questa sezione inseriremo le statistiche per anno e per paziente.</div>
    </section>

    <section id="viewImpostazioni" class="view">
      <div class="settings-card">
        <img class="settings-logo" src="./assets/logo.jpg?v=1.003" alt="Logo" />

        <div id="settingsPhase1" class="settings-phase">
          <div class="settings-actions-grid grid-1x3">
            <button class="settings-action-btn action-edit" id="btnAccModify">modifica account</button>
            <button class="settings-action-btn action-login" id="btnAccLogin">accedi account</button>
          </div>
        </div>

        <div id="settingsPhase2" class="settings-phase hidden">
          <div class="settings-form">
            <input id="accUsername" type="text" placeholder="Nome utente" autocomplete="username" />
            <input id="accPassword" type="password" placeholder="Password" autocomplete="current-password" />
            <input id="accPassword2" type="password" placeholder="Ripeti password" autocomplete="new-password" />
          </div>
          <div class="settings-form-actions">
            <button class="btn secondary" id="btnAccBack">indietro</button>
            <button class="btn primary" id="btnAccSubmit">continua</button>
          </div>
        </div>

        <div id="settingsPhase3" class="settings-phase hidden">
          <div class="settings-logged">
            <span>account:</span> <strong id="loggedUserLabel">—</strong>
          </div>

          <div class="settings-fields">
            <label class="field-label" for="setAnnoEsercizio">Anno di esercizio</label>
            <input id="setAnnoEsercizio" type="number" inputmode="numeric" />

            <label class="field-label" for="setPrezzo1">Costo prestazione livello 1 (€)</label>
            <input id="setPrezzo1" type="number" inputmode="decimal" />

            <label class="field-label" for="setPrezzo2">Costo prestazione livello 2 (€)</label>
            <input id="setPrezzo2" type="number" inputmode="decimal" />

            <label class="field-label" for="setPrezzo3">Costo prestazione livello 3 (€)</label>
            <input id="setPrezzo3" type="number" inputmode="decimal" />
          </div>

          <div class="actionbar">
            <button class="actionbar-btn blue" id="btnSetSave" title="Salva" aria-label="Salva">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 12l4 4L19 6" /></svg>
            </button>
            <button class="actionbar-btn black" id="btnSetReload" title="Ricarica" aria-label="Ricarica">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 12a9 9 0 1 1-3-6.7"/><path d="M21 3v7h-7"/></svg>
            </button>
            <button class="actionbar-btn violet" id="btnAddSocieta" title="Aggiungi società" aria-label="Aggiungi società">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
            </button>
            <button class="actionbar-btn red" id="btnDeleteAccount" title="Cancella account" aria-label="Cancella account">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18"/><path d="M8 6V4h8v2"/><path d="M6 6l1 16h10l1-16"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
            </button>
            <button class="actionbar-btn orange" id="btnLogout" title="Esci" aria-label="Esci">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M10 17l5-5-5-5"/><path d="M15 12H3"/><path d="M21 3v18"/></svg>
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal: Orario giorno -->
  <div class="modal" id="timeModal" role="dialog" aria-modal="true" aria-label="Imposta orario">
    <div class="modal-card">
      <div class="modal-title" id="timeModalTitle">Orario</div>
      <label>Ora inizio</label>
      <input class="input" id="timeInput" type="time" />
      <label>Durata (min)</label>
      <input class="input" id="durInput" type="number" min="0" step="5" placeholder="es. 45" />
      <div class="modal-actions">
        <button class="btn ghost" id="timeCancel" type="button">Annulla</button>
        <button class="btn" id="timeOk" type="button">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20 6 9 17l-5-5"></path></svg>
          OK
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Nuovo paziente -->
  <div class="modal" id="patientModal" role="dialog" aria-modal="true" aria-label="Nuovo paziente">
    <div class="modal-card">
      <div class="modal-title">Scheda paziente</div>

      <label>Nome e Cognome</label>
      <input class="input" id="patName" placeholder="Es. Mario Rossi" />

      <label>Società di appartenenza</label>
      <input class="input" id="patSoc" placeholder="Es. Azienda XYZ" />

      <label>Tipo prestazione</label>
      <div class="pills" id="levelPills">
        <div class="pill" data-level="1">1</div>
        <div class="pill" data-level="2">2</div>
        <div class="pill" data-level="3">3</div>
      </div>

      <div class="row" style="gap:12px">
        <div class="grow">
          <label>Data inizio</label>
          <input class="input" id="patStart" type="date" />
        </div>
        <div class="grow">
          <label>Data fine</label>
          <input class="input" id="patEnd" type="date" />
        </div>
      </div>

      <label>Giorni terapia (tap per impostare orario)</label>
      <div class="pills" id="dayChips">
        <div class="daychip" data-day="lun">Lu</div>
        <div class="daychip" data-day="mar">Ma</div>
        <div class="daychip" data-day="mer">Me</div>
        <div class="daychip" data-day="gio">Gi</div>
        <div class="daychip" data-day="ven">Ve</div>
        <div class="daychip" data-day="sab">Sa</div>
      </div>

      <div style="height:12px"></div>
      <div class="modal-actions">
        <button class="btn ghost" id="patCancel" type="button">Annulla</button>
        <button class="btn" id="patSave" type="button">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20 6 9 17l-5-5"></path></svg>
          Salva
        </button>
      </div>
    </div>
  </div>

  <script src="./config.js?v=1.003"></script>
  <script src="./app.js?v=1.003"></script>
</body>
</html>
